{% extends 'base.html.twig' %}

{% block title %}Ajouter/modifier un enfant{% endblock %}

{% block body %}

    <div class="container container-register">
        <h1>Ajouter/modifier un enfant</h1>
        
        <div class="form-user">

            {{ form_start(form) }}

                {{ form_errors(form) }}

                {{ form_row(form.relation_type) }}
                {{ form_row(form.firstname) }}
                {{ form_row(form.lastname) }}
                {{ form_row(form.gender) }}
                {{ form_row(form.date_of_birth, {
                    'widget': 'single_text',
                    'format': 'yyyy-MM-dd',})
                }}
                {{ form_row(form.nationality) }}
                {{ form_row(form.license_number, {'required': false }) }}
                {{ form_row(form.jersey_number, {'required': false }) }}

                {{ form_row(form.profile_picture, {'label': 'user.profile_picture.label', 'id': 'profile_picture_input', 'row_attr': { 'class': 'profile-picture' }}) }}
                <p class="disclaimer-picture alert alert-warning">{{ 'profile.picture.disclaimer'|trans }}</p>

                <div id="previewPicture">
                    <img id="previewImage" src="">
                </div>

                {{ form_row(form.same_address_as_parent) }}
                
                {{ form_row(form.address_street) }}
                {{ form_row(form.address_number) }}
                {{ form_row(form.zipcode) }}
                {{ form_row(form.locality) }}
                {{ form_row(form.country) }}

                {{ form_row(form.phone_number, {'required': false }) }}
                {{ form_row(form.mobile_number, {'required': false }) }}
                
                {{ form_row(form.email) }}
            </div>

            <button type="submit" class="btn btn-primary">{{ "children.register_children"|trans({}, 'forms') }}</button>

            {{ form_end(form) }}
        </div>

    {% block javascript %}
        {{ encore_entry_script_tags('picturePreview') }}
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const toggleAddressFields = () => {
                    const sameAddressCheckbox = document.querySelectorAll('.same-address-as-parent');

                    for(let i = 0; i < sameAddressCheckbox.length; i++) {
                        sameAddressCheckbox[i].addEventListener('change', function () {
                            const addressFields = sameAddressCheckbox[i].closest('.form-user').querySelectorAll('.address-street, .address-number, .zipcode, .locality, .country');

                            addressFields.forEach((field) => {
                                field.style.display = sameAddressCheckbox[i].children[1].checked ? 'none' : 'block';
                            });
                        });
                    }
                }

                toggleAddressFields();
            });
        </script>
    {% endblock %}
{% endblock %}
